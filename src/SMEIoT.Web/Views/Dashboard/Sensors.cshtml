@using SMEIoT.Views.Helpers
@using Microsoft.AspNetCore.Identity
@using SMEIoT.Core.Entities
@using SMEIoT.Web.ApiModels
@inject SignInManager<User> SignInManager
@inject UserManager<User> UserManager

@section BeforeBundle {
  @{
    var rendered = new Dictionary<string, object>();
    if (SignInManager.IsSignedIn(User))
    {
      var user = await UserManager.GetUserAsync(User);
      rendered["currentUser"] = new BasicUserApiModel(user, await UserManager.GetRolesAsync(user));
    }
    else
    {
      rendered["currentUser"] = new { };
    }
  }
  <dom-json objects="rendered"></dom-json>
}
