@using SMEIoT.Views.Helpers
@using Microsoft.AspNetCore.Identity
@using SMEIoT.Core.Entities
@model SMEIoT.Web.ApiModels.AdminUserApiModel
@inject SignInManager<User> SignInManager
@inject UserManager<User> UserManager
@using SMEIoT.Web.ApiModels

@{
  Layout = "_Layout";
}

@section BeforeBundle {
  @{ await Html.RenderPartialAsync("_CsrfToken"); }
  @{
    var rendered = new Dictionary<string, object>();
    rendered["user"] = @Model;
    if (SignInManager.IsSignedIn(User))
    {
      var user = await UserManager.GetUserAsync(User);
      rendered["currentUser"] = new BasicUserApiModel(user, await UserManager.GetRolesAsync(user));
    }
    else
    {
      rendered["currentUser"] = new { };
    }
  }
  <dom-json objects="rendered"></dom-json>
}
